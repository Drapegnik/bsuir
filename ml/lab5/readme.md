# lab5
> Метод опорных векторов

- Наборы данных `ex5data1.mat` и `ex5data2.mat` содержат три переменные `X1` и `X2` (независимые переменные) и `y` (метка класса). Данные являются линейно разделимыми.

- Набор данных `ex5data3.mat` содержит три переменные `X1` и `X2` (независимые переменные) и `y` (метка класса). Данные разделены на две выборки: обучающая выборка `(X, y)`, по которой определяются параметры модели; валидационная выборка `(Xval, yval)`, на которой настраивается коэффициент регуляризации и параметры Гауссового ядра.

- Набор данных `spamTrain.mat` содержит две переменные `X` - вектор, кодирующий отсутствие `(0)` или присутствие `(1)` слова из словаря `vocab.txt` в письме, и `y` - метка класса: `0` - не спам, `1` - спам. Набор используется для обучения классификатора.

- Набор данных `spamTest.mat` содержит две переменные `Xtest` - вектор, кодирующий отсутствие `(0)` или присутствие `(1)` слова из словаря `vocab.txt` в письме, и `ytest` - метка класса: `0` - не спам, `1` - спам. Набор используется для проверки качества классификатора.

## tasks

1. Загрузите данные `ex5data1.mat` из файла.
2. Постройте график для загруженного набора данных: по осям - переменные `X1`, `X2`, а точки, принадлежащие различным классам должны быть обозначены различными маркерами.
3. Обучите классификатор с помощью библиотечной реализации `SVM` с линейным ядром на данном наборе.
4. Постройте разделяющую прямую для классификаторов с различными параметрами `C=1`, `C=100` (совместно с графиком из пункта 2). Объясните различия в полученных прямых?
5. Реализуйте функцию вычисления _Гауссового ядра_ для алгоритма `SVM`.
6. Загрузите данные `ex5data2.mat` из файла.
7. Обработайте данные с помощью функции _Гауссового ядра_.
8. Обучите классификатор `SVM`.
9. Визуализируйте данные вместе с разделяющей кривой (аналогично пункту 4).
10. Загрузите данные `ex5data3.mat` из файла.
11. Вычислите параметры классификатора `SVM` на обучающей выборке, а также подберите параметры `C` и `σ2` на валидационной выборке.
12. Визуализируйте данные вместе с разделяющей кривой (аналогично пункту 4).
13. Загрузите данные `spamTrain.mat` из файла.
14. Обучите классификатор `SVM`.
15. Загрузите данные `spamTest.mat` из файла.
16. Подберите параметры `C` и `σ2`.
17. Реализуйте функцию предобработки текста письма, включающую в себя:
    - перевод в нижний регистр;
    - удаление `HTML` тэгов;
    - замена `URL` на одно слово (например, `httpaddr`);
    - замена `email`-адресов на одно слово (например, `emailaddr`);
    - замена чисел на одно слово (например, `number`);
    - замена знаков доллара `$` на слово `dollar`;
    - замена форм слов на исходное слово (например, слова `discount`, `discounts`, `discounted`, `discounting` должны быть заменены на слово `discount`). Такой подход называется `stemming`;
    - остальные символы должны быть удалены и заменены на пробелы, т.е. в результате получится текст, состоящий из слов, разделенных пробелами.
18. Загрузите коды слов из словаря `vocab.txt`.
19. Реализуйте функцию замены слов в тексте письма после предобработки на их соответствующие коды.
20. Реализуйте функцию преобразования текста письма в вектор признаков (в таком же формате как в файлах `spamTrain.mat` и `spamTest.mat`).
21. Проверьте работу классификатора на письмах из файлов `emailSample1.txt`, `emailSample2.txt`, `spamSample1.txt` и `spamSample2.txt`.
22. Также можете проверить его работу на собственных примерах.
23. Создайте свой набор данных из оригинального корпуса текстов - http://spamassassin.apache.org/old/publiccorpus/.
24. Постройте собственный словарь.
25. Как изменилось качество классификации? Почему?
26. Ответы на вопросы представьте в виде отчета.

### results

[solution](/ml/lab5/lab5.ipynb) + [report](/ml/lab5/lab5.md)
